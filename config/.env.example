# Wazuh MCP Server - Development Environment Configuration
# Copy this file to .env and update with your actual values

# ===========================================
# WAZUH INDEXER CONFIGURATION
# ===========================================

# Connection Settings
INDEXER_HOST=localhost
INDEXER_PORT=9200
INDEXER_USERNAME=admin
INDEXER_PASSWORD=your_secure_password_here

# SSL/TLS Settings
INDEXER_USE_SSL=true
INDEXER_VERIFY_CERTS=false
INDEXER_SSL_CERT_PATH=
INDEXER_SSL_KEY_PATH=
INDEXER_SSL_CA_PATH=

# Authentication (choose one)
INDEXER_AUTH_TYPE=basic  # basic, api_key, bearer
INDEXER_API_KEY=
INDEXER_BEARER_TOKEN=

# Connection Pool Settings
INDEXER_MAX_CONNECTIONS=10
INDEXER_TIMEOUT=30
INDEXER_RETRY_COUNT=3
INDEXER_RETRY_DELAY=1

# ===========================================
# WAZUH MANAGER CONFIGURATION
# ===========================================

# Connection Settings
MANAGER_HOST=localhost
MANAGER_PORT=55000
MANAGER_USERNAME=wazuh-wui
MANAGER_PASSWORD=your_manager_password_here

# SSL/TLS Settings
MANAGER_USE_SSL=true
MANAGER_VERIFY_CERTS=false
MANAGER_SSL_CERT_PATH=
MANAGER_SSL_KEY_PATH=
MANAGER_SSL_CA_PATH=

# API Configuration
MANAGER_API_VERSION=v1
MANAGER_AUTH_TYPE=basic  # basic, token
MANAGER_API_TOKEN=
MANAGER_LOGIN_ENDPOINT=/security/user/authenticate

# Connection Settings
MANAGER_TIMEOUT=30
MANAGER_RETRY_COUNT=3
MANAGER_RETRY_DELAY=2
MANAGER_MAX_CONNECTIONS=5

# ===========================================
# MCP SERVER CONFIGURATION
# ===========================================

# Server Names
MCP_INDEXER_SERVER_NAME=Wazuh Indexer MCP Server
MCP_MANAGER_SERVER_NAME=Wazuh Manager MCP Server
MCP_SERVER_VERSION=1.0.0

# Transport Configuration
HTTP_ENABLED=true
HTTP_HOST=0.0.0.0
HTTP_PORT_INDEXER=8001
HTTP_PORT_MANAGER=8002

SSE_ENABLED=true
SSE_HOST=0.0.0.0
SSE_PORT_INDEXER=8003
SSE_PORT_MANAGER=8004

STDIO_ENABLED=true

# ===========================================
# LOGGING CONFIGURATION
# ===========================================

# Log Level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO
LOG_FORMAT=detailed  # simple, detailed, json
LOG_FILE_PATH=logs/mcp_server.log
LOG_MAX_SIZE=10MB
LOG_BACKUP_COUNT=5
LOG_ROTATION=time
LOG_ROTATION_INTERVAL=midnight

# ===========================================
# PERFORMANCE & LIMITS
# ===========================================

# Search Limits
MAX_SEARCH_SIZE=10000
DEFAULT_SEARCH_SIZE=100
SCROLL_SIZE=1000
SCROLL_TIMEOUT=1m
BULK_SIZE=500

# Query Limits
MAX_QUERY_TIME=60
MAX_AGGREGATION_SIZE=1000
MAX_SCROLL_TIME=5m

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60
RATE_LIMIT_BURST=20

# ===========================================
# CACHE CONFIGURATION
# ===========================================

CACHE_ENABLED=true
CACHE_TYPE=memory  # memory, redis
CACHE_TTL=300
CACHE_MAX_SIZE=1000

# Redis Cache (if CACHE_TYPE=redis)
CACHE_REDIS_HOST=localhost
CACHE_REDIS_PORT=6379
CACHE_REDIS_DB=0
CACHE_REDIS_PASSWORD=

# ===========================================
# INDEX PATTERNS (WAZUH INDEXER)
# ===========================================

DEFAULT_ALERT_INDEX=wazuh-alerts-*
DEFAULT_STATE_INDEX=wazuh-states-*
DEFAULT_VULNERABILITY_INDEX=wazuh-states-vulnerabilities-*

# ===========================================
# SECURITY SETTINGS
# ===========================================

# Access Control
ALLOWED_IPS=  # Comma-separated list or CIDR notation
BLOCKED_IPS=  # Comma-separated list
RATE_LIMIT_BY_IP=true

# Request Validation
VALIDATE_REQUESTS=true
MAX_REQUEST_SIZE=10MB
MAX_QUERY_COMPLEXITY=1000
SANITIZE_INPUTS=true

# ===========================================
# MONITORING & HEALTH CHECKS
# ===========================================

# Health Check Settings
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3

# Dependency Health Checks
CHECK_INDEXER_HEALTH=true
CHECK_MANAGER_HEALTH=true

# Metrics
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics
METRICS_NAMESPACE=wazuh_mcp

# ===========================================
# DEVELOPMENT SETTINGS
# ===========================================

# Development Mode
DEBUG_MODE=false
DEVELOPMENT_MODE=false

# Hot Reload (development only)
AUTO_RELOAD=false
RELOAD_DIRS=src/

# Testing
TEST_MODE=false
MOCK_WAZUH_SERVICES=false

# ===========================================
# PRODUCTION OVERRIDES
# ===========================================
# Uncomment for production deployments

# LOG_LEVEL=WARNING
# DEBUG_MODE=false
# DEVELOPMENT_MODE=false
# INDEXER_VERIFY_CERTS=true
# MANAGER_VERIFY_CERTS=true
# VALIDATE_REQUESTS=true
# RATE_LIMIT_ENABLED=true
# HEALTH_CHECK_ENABLED=true
